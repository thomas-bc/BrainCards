<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="generator" content="CoffeeCup HTML Editor (www.coffeecup.com)">
  <meta name="dcterms.created" content="Fri, 27 Jun 2014 21:02:23 GMT">
  <meta name="description" content="">
  <meta name="keywords" content="">
  <title></title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <!--[if IE]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <style>
    .draggable_idee
    {
      position:  absolute;
      height: 50px;
      left : 40px;
      top : 40px;
      width: 80px;
      display:table;
      vertical-align: middle;
      margin-left: auto;
      margin-right: auto;
      text-align: center;
      border-radius: 4px;
      color:white;
      background-color: blue;
    }
    .draggable_img
    {
      left : 40px;
      top : 40px;
      position:  absolute;
      height: 50px;
      width: 80px;
      display:table;
      vertical-align: middle;
      margin-left: auto;
      margin-right: auto;
      text-align: center;
      border-radius: 4px;
      margin-bottom: 20px;
      color:white;
      background-color: yellow;
    }
    .draggable_url
    {
      left : 40px;
      top : 40px;
      position:  absolute;
      height: 50px;
      width: 80px;
      display:table;
      vertical-align: middle;
      margin-left: auto;
      margin-right: auto;
      text-align: center;
      border-radius: 4px;
      margin-bottom: 20px;
      color:white;
      background-color: green;
    }
    #container{
      width: 600px;
      height: 400px;
      border-radius: 30px;
      display:inline-block;

    }
    body{
      display: block;
      margin: 0px;
      background-color:orangered;
    }
    #container_elements{
      height: 300px;
      width: 120px;
      display: table;
      margin-left: 30px;
      border-radius: 10px;
      background-color: white;
    }
    .wrapper{
      align-items: center;
      display: flex;
      height: 100%;
      width: 100%;
      margin: 30px;
    }
    .menu_item{
      height: 50px;
      width: 80px;
      display:table;
      vertical-align: middle;
      margin-left: auto;
      margin-right: auto;
      text-align: center;
      border-radius: 4px;
      margin-bottom: 20px;
      color:white;
    }
    #Idée{
      background-color: blue;
    }
    #Image{
      background-color: yellow;
    }
    #URL{
      background-color: green;
    }
    .titre{
      margin-left: auto;
      margin-right: auto;
      text-align: center;
      color: orangered;
    }
    #canvas{
      background-color: white;
      border-radius: inherit;
      height: 400px;
      width: 600px;
    }
    #suppress{
      display:none;
      position: absolute;

    }
    .image{
      position:absolute;
      width: 150px;
      height: 100px;
      left:10px;
      bottom: 10px;
    }
  </style>
  <script>





  var container;
    var nb_elements = 0;
    var canvas;
    var ctx;
    var selected = -1;
    var state_suppress=false;
    function click_canvas(event) {
      if(event.target.id=="canvas"){
        if(selected!=-1){document.getElementById(selected).children[1].style.display="none";
        document.getElementById(selected).children[2].style.display="none";}
        selected = -1;
      }
    }
    function init(){
      container = document.getElementById("container");
      canvas = document.getElementById("canvas");
      ctx = canvas.getContext("2d");
      //ctx.moveTo(10, 10);
      //ctx.lineTo(200, 200);
      //ctx.stroke();
    }
    function drag_start(event) {
      var style = window.getComputedStyle(event.target, null);
      var str = (parseInt(style.getPropertyValue("left")) - event.clientX) + ',' + (parseInt(style.getPropertyValue("top")) - event.clientY) + ',' + event.target.id;
      ctx.stroke();
      event.dataTransfer.setData("Text", str);
    }

    function drop(event) {
      var offset = event.dataTransfer.getData("Text").split(',');
      var dm = document.getElementById(offset[2]);
      dm.style.left = (event.clientX + parseInt(offset[0], 10)) + 'px';
      dm.style.top = (event.clientY + parseInt(offset[1], 10)) + 'px';
      if(parseInt(dm.style.left, 10)>540)dm.style.left="540px";
      if(parseInt(dm.style.top, 10)>370)dm.style.top="370px";
      if(parseInt(dm.style.left, 10)<40)dm.style.left="40px";
      if(parseInt(dm.style.top, 10)<40)dm.style.top="40px";
      event.preventDefault();
      return false;
    }
    function select(){
      console.log(selected);
      if(selected!=-1){document.getElementById(""+selected).children[1].style.display="none";
        document.getElementById(""+selected).children[2].style.display="none";}

      selected = this.id;
      if(state_suppress){
        selected = -1;
        state_suppress=false;
      }
      this.children[1].style.display="inline-block";
      this.children[2].style.display="inline-block";
    }
    function drag_over(event) {
      event.preventDefault();
      return false;
    }
    function del(){
      var parent = this.parentElement;
      selected = -1;
      state_suppress=true;
      parent.parentElement.removeChild(parent);
    }
    function edit(){
      reponse=prompt("value : ")
      if(this.parentElement.className=="draggable_idee")
        this.parentNode.children[0].innerHTML=reponse;
      else if(this.parentElement.className=="draggable_img") {
        this.parentNode.children[0].src = reponse;
        this.parentNode.children[0].className = "image";
        this.parentElement.style.height = this.parentNode.children[0].height+20+"px";
        this.parentElement.style.width = this.parentNode.children[0].width+20+"px";
      }
      else if(this.parentElement.className=="draggable_url") {
        this.parentNode.children[0].children[0].href = reponse;
        this.parentNode.children[0].children[0].innerHTML="link";
      }
    }
    function create(event){
      g = document.createElement('div');
      if(event.target.id=="Idée" || event.target.innerText=="Idée"){
        g.className="draggable_idee";
        g.innerHTML="<p></p>";
      }
      else if(event.target.id=="Image" || event.target.innerText=="Image") {
        g.className="draggable_img";
        g.innerHTML="<img>";
      }
      else if(event.target.id=="URL" || event.target.innerText=="URL") {
        g.className="draggable_url";
        g.innerHTML="<p><a></a></p>"
      }
      g.id=""+nb_elements;
      g.draggable=true;
      g.ondragstart=drag_start;
      g.onclick=select;
      b = document.createElement('button');
      b.style.position="absolute";
      b.style.right="-10px";
      b.style.top = "-10px";
      b.style.display = "none";
      b.onclick=del;
      b.innerHTML="X";
      b.style.borderRadius="50%";
      be = document.createElement('button');
      be.style.position="absolute";
      be.style.left="-10px";
      be.style.top = "-10px";
      be.style.display = "none";
      be.onclick=edit;
      be.innerHTML="<i class=\"fa fa-pencil\"></i>";
      be.style.borderRadius="50%";
      g.appendChild(be);
      g.appendChild(b);
      container.appendChild(g);
      nb_elements++;

    }
  </script>
</head>
<body >
<div class="wrapper">
  <div id="container" ondragover="drag_over(event)" ondrop="drop(event)" onclick="click_canvas(event)">
      <canvas id="canvas"></canvas>
      <button id="suppress">btn</button>
  </div>
  <div id="container_elements">
    <div class="titre"><h1>Outils</h1></div>
    <div class="menu_item" id="Idée" onclick="create(event)"><p>Idée</p></div>
    <div class="menu_item" id="Image" onclick="create(event)"><p>Image</p></div>
    <div class="menu_item" id="URL" onclick="create(event)"><p>URL</p></div>
  </div>
</div>
</body>
<script type="application/javascript">
  init();
</script>
</html>
